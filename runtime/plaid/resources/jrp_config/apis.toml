[apis."general"]
[apis."general".network.web_requests]


[apis."general"."network"."web_requests"."google_test"]
verb = "get"
uri = "https://www.google.com/"
return_body = true
return_code = true
return_cert = true
available_in_test_mode = true
allowed_rules = ["just_run_please.wasm"]
[apis."general"."network"."web_requests"."google_test"."headers"]

[apis."general"."network"."web_requests"."testmode_allow"]
verb = "get"
uri = "https://captive.apple.com/"
return_body = true
return_code = true
return_cert = true
allowed_rules = ["just_run_please.wasm"]
available_in_test_mode = true
[apis."general"."network"."web_requests"."testmode_allow"."headers"]

[apis."general"."network"."web_requests"."testmode_deny"]
verb = "get"
uri = "https://captive.apple.com/"
return_body = true
return_code = true
return_cert = true
allowed_rules = ["just_run_please.wasm"]
available_in_test_mode = false
[apis."general"."network"."web_requests"."testmode_deny"."headers"]

# [apis."general"."network"."web_requests"."list_deploy_keys"]
# verb = "get"
# uri = "https://api.github.com/repos/{owner}/{repo}/keys"
# return_body = true
# return_code = true
# allowed_rules = ["testing_test.wasm"]
# [apis."general"."network"."web_requests"."list_deploy_keys"."headers"]
# Authorization = "Bearer github_pat_11AAS..."
# "X-GitHub-Api-Version" = "2022-11-28"
# "Accept" = "application/vnd.github+json"
# "User-Agent" = "Plaid/0.10"

# [apis."general"."network"."web_requests"."create_deploy_key"]
# verb = "post"
# uri = "https://api.github.com/repos/{owner}/{repo}/keys"
# return_body = false
# return_code = true
# allowed_rules = ["testing_test.wasm"]
# [apis."general"."network"."web_requests"."create_deploy_key"."headers"]
# Authorization = "Bearer github_pat_11AAS..."
# "X-GitHub-Api-Version" = "2022-11-28"
# "Accept" = "application/vnd.github+json"
# "User-Agent" = "Plaid/0.10"

# [apis."github"]
# token = ""
# [apis."github".graphql_queries]

[apis."slack"]
[apis."slack"."webhooks"]
[apis."slack"."bot_tokens"]

[apis."web"]
[apis."web".keys]
[apis."web".keys."46c642b0da02030407c6463c013a8dbd"]
# To generate the ECDSA256 key PEM, run the following commands:
# openssl ecparam -genkey -name prime256v1 -out ec-params.key
# openssl pkcs8 -topk8 -nocrypt -in ec-params.key -out private-key.pem
# openssl ec -in ec-params.key -pubout

# This is the example private key from JWT.io. Do not use it in production.
private_key = """
-----BEGIN PRIVATE KEY-----
MIGHAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBG0wawIBAQQgevZzL1gdAFr88hb2
OF/2NxApJCzGCEDdfSp6VQO30hyhRANCAAQRWz+jn65BtOMvdyHKcvjBeBSDZH2r
1RTwjmYSi9R/zpBnuQ4EiMnCqfMPWiZqB4QdbAd0E7oH50VpuZ1P087G
-----END PRIVATE KEY-----
"""

key_type = "es256"
allowed_rules = ["test_jwt.wasm"]
allowlisted_extra_fields = ["ext"]
allowlisted_extra_headers = ["smt", "cty"]

[apis."web".keys."230216b400a90b29f70db61aca97bbca"]
# This is a test key. Do not use it in production.
private_key = """
-----BEGIN PRIVATE KEY-----
MIGHAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBG0wawIBAQQgO7Efw+K7iAHg6+E2
ClqcPgx7lsGbpkrbVDO7kzT8MfChRANCAARjZdpuBQmWKxr+CFwiWQcXo8qeZvBr
sa5i5Zy6yHszl8nBOEWDUOx2RC6UKaCPT+dgr8O4OZ/d0PKGMo0a4a69
-----END PRIVATE KEY-----
"""

key_type = "es256"
allowed_rules = ["testing_test.wasm"]

[apis."web".keys."0260c8c6d8f48d959858c57fc7392748"]
# To generate an RSA key PEM, run the following command:
# openssl genpkey -algorithm RSA -pkeyopt rsa_keygen_bits:2048 -out rsa_2048_private.pem
# This is a test key. Do not use it in production.
private_key = """
-----BEGIN PRIVATE KEY-----
MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQC8DGpRez+f61FI
TBh6kAymntVXHyit+G6tsrP/WF+U71DvgGQ3XeQ2dxcrekk6MMaBtscTtXX4oM82
x+RYuY/nNHbA+se9cSLC8b4WNtJjCnpMpUM4YAve2zOioYRR/UCWI8R0REWSExpk
gXewUmb+egF8xbuJ4i1AQlH7nGuDh8Jde1QfpV2s6WA0+/SQSToOJYH3rowImcRL
Ok9auhCfZMmx+hT0wjj9Hm75nCXtHaRpnX/FuX/uM3nbKmoA/7ABOrLip+KnTYVM
ZgJ1nIubOHegOkHOhdJ/1y/xLZYXeeUSJo8yULKi9eZvoWNK6fRWtkuvQ0exweOc
Ks06MI39AgMBAAECggEAK3nEV9fCjzbAqVIcg7OLlTcaFEUaKtSJxCNRbZrRKFYG
9IROxyUwNq5kXzMrvGYb8s/e6U3V+zg0iBIBV0j5feb5gKbKKKCAPKlWvPyKOgcp
XNCFgMJl5C1yG+qzNKB0PvIAgK/rFLlRbASptwxqDvIGp4HwmJF/zEA5A463paYG
ei1+CQUSpfinrLBKkAl6mV1jXQ2pZGlHWg//NqvXJ3c9NwAws3a+5e14cOr2C0nj
aCgki9sNUgPzPS98xGheiJ3t/6qE+LQ5jUKtXPTclawHpCk6QpWbxXPa0O7wcWDs
dXdtCpx/yVIMaY9VQyDcFAUkcqjx2SxwSSe+6Gm0IQKBgQD4gtJcQLHoIfAd5Sii
VJeO9LBGFQjze58Qql/wDmKFTtWujHZlZf3uHxblbyRPFZx4VGBU3SrpZF+R/cEO
KUyofknbmycvs+2NjjkrGofnqFN901s4LvMjDPp2ageUgufP/zIbs5X8J0OB1prA
A9MDB7KFvF+/0UhEGSBRxBZvIQKBgQDBtyVM5gQNWa8FWsmDYsKvLZ1h/qJcfUWW
bCl4HpMhRZhxLggNUWcAMH7bcM4eMl3lEtoAyqZdpjh/p2aHjs8OXxNzLLbX47JQ
MTs0ak3aWSmTXMdXt/bWV3WcFiH9xgBZ0xywLxPzC3cpOFcTwwA7MzEyrjA1LKhI
B0Q2xN9PXQKBgQCE+KMMn8VR+07bADJE4dSStpTXewvmFIChTzi0X04SHIOzuQ7k
5LUBw/rhWx3nfx3ROPyujAUZCw8kM84oAKs3ARQOAK/wE2uJsc8fJDwSFXxPOFd3
8Y9BcwFVeRiDO6REJD2wmuAnIu85OxZkpeczmNvKOWhWX+o2HeewOKb0YQKBgGs0
XRsyjHmK8XZIKQ9iH5Xs65Vo4xfGaDV4BHcqjIg0SMoSDHi6XQNY00vEIP3LJ/V3
OliHzgwzyj6zOOW6XdJ5QX1S+Jl/tJX2uOooDo/RGlYoWVWtRJiYbEkGYqdb5aPQ
VqcWVrcB2F9ig6Y3G7CngwmmJp226iZ6hwC8cU0tAoGBAOTinqbspmK9d6QzUlyk
9o0pelY2dFqh/3DizDiBITgos2QS22qwty2pcc5/dt9O7gkBBbWxtQuXU5n9mhfs
BLaCPYKOdilAcJUHkecVotP3qre58wV2M6GlF/uZR5ChffRvFS4n6a8uj1tdl+Kj
YguxxuhDa6BnBlFU9lfnLzM5
-----END PRIVATE KEY-----

"""

key_type = "rs256"
allowed_rules = ["test_jwt.wasm"]

[apis."web".keys."0260c8c6d8f48d959858c57fc7392748"."enforced_claims"]
aud = "audience"
iss = "issuer"

[apis."yubikey"]
client_id = 99999
secret_key = ""

# BLOCKCHAIN EVM EXAMPLE CONFIGURATION
# [apis."blockchain"]
# [apis."blockchain"."evm"]
# max_retries = 5
# timeout_millis = 10000

# [apis."blockchain"."evm".chains.1] # Ethereum 
# selection_strategy = "RoundRobin"

# [[apis."blockchain"."evm".chains.1.nodes]]
# uri = "https://some-node"
# name = "Node 1"

# [[apis."blockchain"."evm".chains.1.nodes]]
# uri = "https://some-other-node"
# name = "Node 2"


# KMS USING IAM

# [apis."aws"]
# [apis."aws"."kms".authentication]
# [apis."aws"."kms".key_configuration]
# "some_key_id" = ["testing_test.wasm", "another_rule.wasm"]

# KMS USING API KEY

# [apis."aws"]
# [apis."aws"."kms"]
# [apis."aws"."kms".authentication]
# access_key_id = "asdf"
# secret_access_key = "asdf"
# region = "asdf"
# [apis."aws"."kms".key_configuration]
# "some_key_id" = ["testing_test.wasm", "another_rule.wasm"]


# S3 (using IAM)
# top‚Äêlevel bucket_configuration map
# [apis."aws"]
# [apis."aws"."s3"]
# [apis."aws"."s3".authentication]
# [apis."aws"."s3".bucket_configuration]
# for bucket named "my-bucket"
# [apis."aws"."s3".bucket_configuration."my-bucket"]
# r = ["some_rule.wasm"]
# rw = ["another_rule.wasm"]

# DynamoDB (using IAM)
# [apis."aws"]
# [apis."aws"."dynamodb"]
# local_endpoint = true
# [apis."aws"."dynamodb".authentication]
# [apis."aws"."dynamodb".rw]
# local_test = ["test_dynamodb.wasm"]

# [apis."aws"."dynamodb".r]

#[apis."github"]
#[apis."github".authentication]
#logbacks_allowed = "Unlimited"
#app_id = 0
#installation_id = 0
#private_key = """{plaid-secret{plaid-github-app-private-key}}"""

# [apis."github"."graphql_queries"]
# saml_identities = """
# query($organization: String!, $cursor: String) {
#   organization(login: $organization) {
#     samlIdentityProvider {
#       externalIdentities(first: 100, after: $cursor) {
#         pageInfo {
#           hasNextPage
#           endCursor
#         }
#         nodes {
#           user {
#             login
#           }
#           samlIdentity {
#             nameId
#           }
#         }
#       }
#     }
#   }
# }
# """

[apis.cryptography.aes]
[[apis.cryptography.aes.key_specs]]
id = "my_aes_key"
key = "34958749579573957968934692346934" # This is just an example key. !!! DO NOT USE IN PRODUCTION !!!
rules_and_actions = { "test_aes_enc_dec.wasm"  = ["Encrypt", "Decrypt"] }

[[apis.cryptography.aes.key_specs]]
id = "aes_key_only_enc"
key = "34958749579573957968934692346935" # This is just an example key. !!! DO NOT USE IN PRODUCTION !!!
rules_and_actions = { "test_aes_enc_dec.wasm"  = ["Encrypt"] }

[[apis.cryptography.aes.key_specs]]
id = "another_aes_key"
key = "34958749579573957968934692346936" # This is just an example key. !!! DO NOT USE IN PRODUCTION !!!
rules_and_actions = { "some_rule.wasm"  = ["Encrypt", "Decrypt"] }
